<?php

namespace CoreBundle\Logic;

class UsigWS{

    private static function GET_JSON_OBJECT_FROM_PAGE($URL,$timeout,$json = true)
    {       
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $URL);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
        $respuesta = curl_exec($ch);
        curl_close($ch);
        
        if($json == true){
            return (json_decode($respuesta,true));
        }else{
            return $respuesta;
        }       
    }
    

    public static function GET_DIRECCION_NORMALIZADA(&$resultados, $pedido, $calle, $altura)
    {
      $URL = "http://ws.usig.buenosaires.gob.ar/rest/normalizar_y_geocodificar_direcciones?calle=" .urlencode($calle). "&altura=" .$altura ."&desambiguar=1";     
      //normalizar_y_geocodificar_direcciones?calle=sarmiento&altura=500&desambiguar=1      DireccionNormalizada POSTA ___ 0 Ambiguedad
      $datos = self::GET_JSON_OBJECT_FROM_PAGE($URL,5);   
      $resultados[$pedido]["Mensaje"]["Normalizacion"] = $datos["Normalizacion"]["TipoResultado"];

      if ($datos["Normalizacion"]["TipoResultado"] == 'Ambiguedad')
      {     
        $resultados[$pedido]["Resultados"] = 'Ambiguedad';    
      
      }elseif ($datos["Normalizacion"]["TipoResultado"] == 'DireccionNormalizada'){
        $resultados[$pedido]["Resultados"] = 'OK';
        $resultados[$pedido]["CodigoCalle"] = $datos["Normalizacion"]["DireccionesCalleAltura"]["direcciones"][0]["CodigoCalle"];
        $resultados[$pedido]["Calle"] = $datos["Normalizacion"]["DireccionesCalleAltura"]["direcciones"][0]["Calle"];
        $resultados[$pedido]["Altura"] = $datos["Normalizacion"]["DireccionesCalleAltura"]["direcciones"][0]["Altura"];
        $resultados[$pedido]["x"] = $datos["GeoCodificacion"]["x"];
        $resultados[$pedido]["y"] = $datos["GeoCodificacion"]["y"];

        //print_r($datos["Normalizacion"]["DireccionesCalleAltura"]["direcciones"][0]["CodigoCalle"]);

        $URL = "http://ws.usig.buenosaires.gob.ar/rest/convertir_coordenadas?x=" .$resultados[$pedido]["x"]. "&y=" .$resultados[$pedido]["y"]. "&output=lonlat";
        //                                           /convertir_coordenadas?x=100000&y=100000&output=lonlat
        // YA LO TENGO :p
        //echo $URL;
        $datos = self::GET_JSON_OBJECT_FROM_PAGE($URL,5);
        if ($datos["tipo_resultado"] == 'Ok'){
            $resultados[$pedido]["Long"] = $datos["resultado"]["x"];
            $resultados[$pedido]["Lat"] = $datos["resultado"]["y"];
        }

        $URL = "http://ws.usig.buenosaires.gob.ar/datos_utiles/?calle=".urlencode($resultados[$pedido]["Calle"])."&altura=".$resultados[$pedido]["Altura"];
        $datos = self::GET_JSON_OBJECT_FROM_PAGE($URL,5);

        $resultados[$pedido]["comuna"] = str_replace("Comuna ", "", $datos['comuna']);
        $resultados[$pedido]["barrio"] = $datos['barrio'];
        $resultados[$pedido]["Comisaria"] = $datos['comisaria'];
        $resultados[$pedido]["Hospital"] = $datos['area_hospitalaria'];
        $resultados[$pedido]["CodigoPostal"] = $datos['codigo_postal'];

        $URL = "http://ws.usig.buenosaires.gob.ar/geocoder/2.2/smp?cod_calle=".$resultados[$pedido]["CodigoCalle"]."&altura=".$altura;
        $datos = self::GET_JSON_OBJECT_FROM_PAGE($URL,5,false);
        $smp = explode('"',$datos);             
        if($smp[1]=='ErrorPuertaInexistente'){
            $URL = "http://ws.usig.buenosaires.gob.ar/geocoder/2.2/reversegeocoding?x=" .$resultados[$pedido]["x"]. "&y=" .$resultados[$pedido]["y"];
            $datos = self::GET_JSON_OBJECT_FROM_PAGE($URL,5,false);
            $smp = explode('"',$datos);
            $resultados[$pedido]["smp"] = $smp[3];
            $resultados[$pedido]["cmr"] = self::esCMR($smp[3]);
            $resultados[$pedido]["pdamatriz"] = 0;
        }else{
            $resultados[$pedido]["smp"] = trim($smp[3]);
            $resultados[$pedido]["cmr"] = self::esCMR(trim($smp[3]));
            if(trim($smp[16]) == ":"){
                $resultados[$pedido]["pdamatriz"] = trim($smp[17]); 
            }else{
                $resultados[$pedido]["pdamatriz"] = trim($smp[16]); 
            }           
        }       
      }
      else {
        $resultados[$pedido]["Resultados"] = 'ERROR';
        //  echo "errorresultado";
      }
    }

    public static function normalizarDireccion(&$direccion,&$messageError,&$messageAmbiguedad)
    {
        self::GET_DIRECCION_NORMALIZADA($direccionNormalizada,"normalizado",$direccion->getCalle(),$direccion->getAltura());
        if($direccionNormalizada["normalizado"]["Resultados"] == "OK"){
            $direccion->setLon($direccionNormalizada["normalizado"]["Long"]);
            $direccion->setLat($direccionNormalizada["normalizado"]["Lat"]);
            //$direccion->setSMP($direccionNormalizada["normalizado"]["smp"]);
            $direccion->setSMP(str_replace("\\","", html_entity_decode(preg_replace('/u([\da-fA-F]{4})/', '&#x\1;',$direccionNormalizada["normalizado"]["smp"]))));
            $direccion->setCmr($direccionNormalizada["normalizado"]["cmr"]);
            if($direccionNormalizada["normalizado"]["pdamatriz"] != ':null})'){             
                $direccion->setPMatriz($direccionNormalizada["normalizado"]["pdamatriz"]);  
            }else{
                $direccion->setPMatriz("0");
            }
            
            $direccion->setComuna($direccionNormalizada["normalizado"]["comuna"]);  
            return true;
        }elseif($direccionNormalizada["normalizado"]["Resultados"] == "ERROR"){
            $var = $direccion->getCalle();          
            if(!is_null( $var ) ){
                $messageError .="No se ha podido guardar la direcciÃ³n ".$direccion->getCalle()->getCalle()." ".$direccion->getAltura().", Altura Inexistente <br>";
                return false;
            }            
        }elseif($direccionNormalizada["normalizado"]["Resultados"] == "Ambiguedad"){
            $messageAmbiguedad .="No se ha podido guardar la direcciÃ³n por ambiguedad ".$direccion->getCalle()->getCalle()." ".$direccion->getAltura()." <br>";
            return false;
        }else{
            //return $this->redirectToRoute('error_page');
        }
    }

    private static function esCMR($smp){
        $smp = explode("-", $smp);
        $seccion = array();
        $manzana = array();

        array_push($seccion,6,10,18,26,32,34,38,44,46,48,50,52,56,58,64,66,68,70,78,80,82,84);
        array_push($manzana,'72#17#','72#001B#','72#022B#','72#27#','72#002A#','72#19#','72#001A#','72#18#','72#022A#','74#030A#','74#23#','74#22#','74#14#','74#029B#','74#020C#','74#013A#','74#013B#','74#6#','74#005A#','74#012B#','74#012C#','74#004A#','74#012A#','74#011Z#','74#011B#','74#011C#','74#003A#','74#002A#','74#019C#','74#021A#','74#019A#','74#020A#','74#028B#','74#027B#','74#018A#','74#018B#','74#018C#','74#010A#','74#010B#','74#009B#','74#009A#','74#017B#','74#017A#','74#026B#','74#026A#','74#001C#','74#009C#','74#001B#','74#001A#','74#008B#','74#007A#','74#008A#','74#017C#','74#016C#','74#015B#','74#016A#','74#016B#','74#025B#','74#24#','74#015A#','74#025A#','74#31#','74#32#','74#40#','74#039B#','74#039A#','74#47#','74#48#','74#57#','74#56#','74#66#','74#74#','74#83#','65#51#','65#61#','65#71#','65#81#','65#99#','65#110A#','36#119#','36#118#','36#117#','36#116#','36#115#','36#114#','36#113#','36#112#','36#111#','36#110#','36#109#','36#108#','36#107#','36#106#','36#105#','36#104#','36#103#','36#137#','36#136#','36#135#','36#134#','36#133#','36#132#','36#131#','36#130#','36#129#','36#128#','36#127#','36#126#','36#125#','36#124#','36#99#','36#98#','36#80#','36#97#','36#96#','36#95#','36#94#','36#93#','36#92#','36#89#','36#88#','36#86#','36#77#','36#78#','36#76#','36#75#','36#57#','36#24#','36#39#','36#056A#','36#056B#','36#73#','36#74#','36#8#','36#23#','36#38#','36#54#','36#55#','36#71#','36#72#','36#5#','36#020A#','36#020B#','36#036A#','36#036B#','36#051A#','36#051B#','36#69#','36#91#','36#90#','36#68#','36#50#','36#35#','36#19#','36#4#','36#3#','36#18#','36#34#','36#49#','36#67#','36#123#','36#122#','36#66#','36#48#','36#33#','36#17#','36#2#','36#1#','36#16#','36#32#','36#47#','36#65#','36#87#','36#121#','28#31#','28#30#','28#29#','28#28#','28#27#','28#26#','28#35#','28#36#','28#37#','28#42#','28#43#','28#7#','28#6#','28#5#','28#4#','28#3#','28#2#','28#1#','28#16#','28#15#','28#14#','28#13#','28#12#','28#11#','28#10#','28#9#','28#24#','28#23#','28#22#','28#21#','28#20#','28#19#','28#18#','22#1#','22#2#','22#3#','22#4#','22#5#','22#6#','22#17#','22#16#','22#15#','22#14#','22#22#','22#23#','22#24#','4#31#','4#38#','4#47#','4#53#','28#016#','18#103#','18#128#','123#9#','71#013B#','42#004B#','083C#15#','073B#5#','58#003B#','42#007B#','54#2#','041A#20#','095A#4#','29#17#','44#0FRD#','14#010B#','003A#5#','20#34#','102#040D#','103#019A#','87#9#','55#1#','090Y#PLT1#','104A#2#','029A#31#','165B#13#','77#3#','30#004A#','126#21#','170#12#','002A#002B#','43#11#','19#30#','1#14#','20#30#','18#028A#','96#4#','31#27#','72#028A#','95#25#','013A#15#','073B#5#','55#1#','7#3#','090Y#PLT1#','20#14#','090Y#PLT1#','51#13#','31#028B#','95#16#','119#902A#','119#902A#','47#10#','182#30#','82#3#','24#037B#','30#24#','27#46#','45#10#','56#20#','090Y#PLT1#','014B#007B#','053C#31#','078A#001C#','81#15#','090Y#PLT1#','38#27#','128#013B#','46#25#','013A#15#','014B#007B#','090Y#PLT1#','049A#5#','96#4#','030B#4#','150#009H#','049B#004A#','058B#20#','39#001A#','48#11#','050A#20#','19#010B#','019A#26#','073Q#27#','33#15#','32#17#','6#030A#','97#019B#','7#15#','60#27#','15#004A#','157#17#','61#010F#','011E#3#','5#018A#','94#35#','090Y#PLT1#','55#1#','123#9#','6#028A#','22#20#','84#12#','30#18#','006A#15#','14#1#','001A#033A#','65#18#','53#29#','117B#003A#','71#013B#','37#012B#','79#12#','52#4#','073Q#27#','086A#0#','086A#0#','021B#14#','48#23#','157#17#','5#10#','171B#7#','156A#4#','3#005B#','18#28#','97#2#','81#9#','60#002C#','56#20#','96#013A#','93#4#','35#027A#','90#010A#','3#42#','55#1#','159#23#','016A#16#','090Y#PLT1#','26#018A#','85#27#','57#015A#','60#27#','077A#54#','141C#0#','166#005B#','23#027A#','140#24#','50#915B#','7#005N#','22#12#','81#5#','8#12#','75#029A#','109C#0#','124#018A#','107#12#','154#020G#','24#16#','57#11#','55#1#','38#12#','146#006A#','108#PLT1#','79#17#','56#20#','3#9#','090Y#PLT1#','64#005A#','38#10#','103#22#','31#5#','81#8#','090Y#PLT1#','56#011G#','56#011G#','56#011G#','85#27#','2#59#','80#016A#','090Y#PLT1#','157#17#','51#015C#','128A#B116#','81#5#','43#21#','63#012D#','090Y#PLT1#','16#5#','55#1#','60#16#','41#39#','48#12#','128#19#','93#15#','090Y#PLT1#','110#46#','34#10#','67#7#','140#1#','99#017A#','11#005B#','55#1#','011A#001C#','011A#001C#','011A#001C#','143#010A#','96#4#','139A#25#','18#3#','12#017A#','057Z#PLT1#','67#18#','12#3#','145#0FRI#','73#006E#','36#19#','90#1#','090Y#PLT1#','011Z#PLT1#','011Z#PLT1#','71#9#','135#27#','049A#29#','82#2#','10#13#','93#008B#','96#4#','33#014A#','049A#29#','076A#20#','19#AU11#','10#031A#','34#001A#','039B#26#','98#42#','10#031A#','10#031A#','136#30#','157Z#PLZ1#','89#7#','157Z#PLZ1#','128#017A#','55#1#','73#30#','41#39#','090Y#PLT1#','068A#0#','38#10#','41#039B#','152#008A#','013A#15#','146#42#','140#023A#','033Y#PLT1#','34#10#','14#1#','77#33#','005A#1#','29#34#','155#011C#','049A#29#','078B#6#','8#9#','95#20#','73#30#','131Z#PLT1#','69#001C#','48#19#','128#40#','39#23#','28#24#','52#026A#','93#007D#','005A#0FRC#','013B#4#','9#001B#','049A#29#','26#25#','32#3#','116#035A#','60#002C#','126#9#','55#1#','55#1#','55#1#','55#1#','90#1#','105#003C#','8#11#','146#42#','2#36#','81#905A#','6#028A#','70#35#','60#27#','93#008B#','56#20#','62#8#','016A#16#','140#23#','20#29#','65#13#','65#13#','65#13#','55#1#','97#019B#','58#22#','8#12#','70#51#','83#001B#','090Y#PLT1#','55#1#','93#10#','128B#5#','55#1#','141C#0#','55#1#','56#35#','26#0FRC#','55#1#','74#15#','34#17#','090Y#PLT1#','55#1#','69#4#','61#15#','157#17#','55#1#','111#7#','96#4#','93#12#','93#9#','146#006A#','61#033B#','72#028A#','38#27#','38#035B#','55#1#','090Y#PLT1#','090Y#PLT1#','83#001B#','6#036A#','71#4#','55#1#','090Y#PLT1#','52#016A#','156#9#','1#NP04#','007A#6#','012Z#PLT1#','38#029C#','41#4#','96#009C#','41#013A#','73#006E#','19#7#','2#6#','037A#25#','160#7#','36#001A#','171#11#','3#5#','157#21#','128B#4#','73#30#','10#31#','109#020A#','55#1#','090Y#PLT1#','71#30#','35#027A#','148#23#','10#23#','55#1#','090Y#PLT1#','80#16#','99#008C#','55#1#','090Y#PLT1#','11#24#','108#031B#','7#20#','45#018A#','79#28#','7#2#','3#008A#','3#008A#','34#019B#','60#3#','124#011A#','93#007D#','005A#0FRC#','24#16#','55#1#','55#1#','41#27#','41#39#','090X#PLT1#','17#8#','185#8#','40#026C#','200#37#','71#13#','27#1#','085A#26#','34#33#','55#1#','090Y#PLT1#','71#022A#','003B#19#','087A#001B#','16#17#','20#30#','6#030A#','18#028A#','31#27#','61#15#','185#5#','78#45#','41#021A#','55#1#','51#49#','38#001P#','108#11#','75#1#','29#008E#','58#22#','034A#004C#','27#34#','165#42#','55#1#','156B#0FRA#','65#10#','3#010A#','39#19#','41#021A#','48#8#','45#10#','156#9#','004C#001A#','59#013A#','55#1#','49#49#','10#31#','34#10#','41#27#','113A#015H#','137#AU11#','55#1#','185#6#','153#2#','55#1#','55#1#','55#1#','015B#14#','27#46#','47#024A#','101#33#','097B#35#','111#28#','156B#0FRA#','155#11#','171#4#','55#1#','119#902A#','119#902A#','108#031B#','148#23#','55#1#','090Y#PLT1#','56#20#','129#001B#','58#22#','58#22#','3#007A#','127#13#','37#18#','55#1#','157#17#','55#1#','55#1#','090Y#PLT1#','23#6#','13#15#','12#4#','60#2#','84#24#','55#1#','090Y#PLT1#','152A#31#','22#001C#','10#31#','47#011A#','7#20#','44#6#','005A#1#','59#1#','113A#001B#','38#30#','55#1#','57#36#','46#0#','98#11#','6#030A#','23#7#','21#24#','60#3#','18#028A#','93#008B#','55#1#','55#1#','4#PLZ1#','21#37#','67#13#','70#31#','65#0FRB#','60#15#','55#1#','55#1#','090Y#PLT1#','38#029C#','52#4#','35#10#','013B#011A#','055A#002I#','090Y#PLT1#','40#026C#','134Z#PLT1#','56#011G#','56#011G#','56#011G#','55#1#','137#27#','3#008A#','24#008A#','21#22#','155#11#','3#008G#','55#1#','50#0#','50#0#','50#0#','24#AU11#','41#19#','58#3#','16#17#','93#19#','55#1#','44#0FRA#','090Y#PLT1#','55#1#','89#12#','5#26#','4#39#','55#1#','72#21#','44#9#','60#3#','21#015D#','55#1#','21#24#','048E#0FRA#','61#15#','31#27#','96#4#','124#011A#','165#42#','69#25#','55#1#','090Y#PLT1#','69#013A#','69#30#','69#018B#','69#32#','89#5#','89#14#','79#3#','79#16#','79#24#','79#32#','79#038B#','79#41#','37#34#','52#004B#','113A#12#','057F#0#','64#001I#','103A#17#','012Z#PLT1#','55#1#','55#1#','090Y#PLT1#','56#20#','97#009G#','55#1#','090Y#PLT1#','8#15#','099B#33#','83#013A#','059A#6#','44#0FRA#','101#37#','21#24#','9#14#','15#001A#','42#001A#','3#007A#','55#1#','55#1#','146#29#','157#17#','039C#4#','65#22#','70#33#','43#21#','83#4#','93#001C#','055A#002I#','32#25#','55#1#','55#1#','090Y#PLT1#','12#017A#','22#18#','16#33#','55#1#','090Y#PLT1#','109#21#','8#12#','8#15#','81#31#','65#22#','053C#31#','70#38#','75#16#','85#001A#','7#23#','155C#31#','63#33#','108#031B#','121Y#PT01#','113A#12#','22#18#','111#006C#','55#1#','55#1#','123#009B#','71#23#','005A#1#','65#034A#','45#6#','114#31#','14#33#','55#1#','55#1#','93#001C#','5#7#','61#33#','179#005A#','26#017B#','52#20#','5#25#','23#012A#','55#1#','090Y#PLT1#','55#1#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','55#1#','65#13#','65#13#','65#13#','71#15#','26#020A#','6#33#','21#24#','170#038F#','3#22#','18#3#','090Y#PLT1#','76#26#','55#1#','42#38#','70#17#','1#31#','30#17#','7#016A#','7#012A#','42#34#','58#10#','55#1#','153#001D#','31#001D#','55#1#','71#23#','35#9#','89#12#','86#19#','125#1#','32#22#','69#5#','57#14#','13#16#','12#17#','5#11#','16#32#','3#006B#','2#8#','55#1#','33#7#','35#8#','64#005A#','55#1#','28#030A#','7#23#','005A#1#','71#23#','55#1#','090Y#PLT1#','071Z#PLZ1#','55#19#','16#17#','40#19#','55#1#','17#022A#','48#028A#','28#24#','28#35#','27#019O#','19#22#','8#031A#','66#21#','141#19#','140#10#','126#001D#','78#45#','38#017B#','60#27#','23#30#','55#1#','119#011A#','34#10#','35#027A#','24#22#','020A#26#','114#31#','004B#0FRL#','1#014A#','1#17#','1#029A#','18#12#','42#15#','10#024A#','2#6#','1#13#','75#27#','94#1#','94#35#','21#37#','137#37#','60#11#','55#1#','117#27#','055B#1#','81#4#','27#17#','090Y#PLT1#','8#021A#','51#15#','66#25#','93#007D#','109#21#','29#7#','17#28#','58#13#','080A#15#','117#016A#','5#26#','42#9#','19#9#','7#20#','55#1#','090Y#PLT1#','55#1#','55#1#','090Y#PLT1#','111#016B#','5#11#','14#005D#','71#10#','73#35#','55#1#','090Y#PLT1#','55#1#','29#17#','55#1#','71#3#','71#10#','006B#2#','53#13#','020A#26#','107#6#','16#33#','21#015D#','016A#16#','134#17#','36#3#','154#42#','50#017B#','89#12#','55#1#','1#009B#','4#6#','105B#35#','108#005B#','60#27#','55#1#','090Y#PLT1#','95#16#','56#20#','8#15#','090Y#PLT1#','55#1#','152A#31#','005A#1#','153#001D#','43#24#','66#25#','18#028A#','29#005A#','55#1#','42#004A#','89#14#','045Z#FR01#','21#22#','55#1#','55#1#','55#1#','147#9#','55#1#','55#1#','090Y#PLT1#','7#27#','83#8#','090Y#PLT1#','55#1#','033Y#PLT1#','211#34#','22#25#','055A#6#','009Z#PLT1#','16#33#','7#016A#','55#1#','55#1#','83#19#','63#012A#','108#11#','67#5#','154#42#','55#1#','090Y#PLT1#','83#1#','83#003B#','83#9#','87#001A#','87#31#','040B#14#','040B#18#','090Y#PLT1#','55#1#','013A#7#','16#33#','9#14#','32#21#','2#6#','117#011A#','5#22#','10#31#','55#1#','55#1#','75#23#','33#34#','56#3#','55#1#','55#1#','31#028B#','016A#16#','93#008B#','95#5#','38#10#','55#1#','182#30#','55#1#','55#1#','31#014A#','155#32#','2#42#','16#33#','005A#1#','55#1#','055B#4#','55#1#','55#1#','55#1#','090Y#PLT1#','54#21#','183#33#','212#29#','55#1#','090Y#PLT1#','42#9#','9#21#','55#1#','84#045A#','55#1#','16#33#','94#9#','55#1#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','56#10#','56#10#','62#010F#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','60#27#','61#006B#','38#0#','129#001B#','71#25#','72#0FRA#','123#009A#','056B#8#','66#7#','73#001K#','107#10#','119#902A#','119#902A#','56#029A#','55#1#','12#15#','029C#017A#','93#008B#','38#10#','94#1#','66#17#','141#1#','097A#20#','090Y#PLT1#','85#21#','090Y#PLT1#','090Y#PLT1#','23#25#','141#040A#','043A#24#','51#022A#','73#001K#','044A#1#','31#17#','007B#14#','90#010A#','188#002A#','75#1#','90#17#','93#001A#','109#19#','56#14#','144#20#','7#3#','29#14#','55#1#','090Y#PLT1#','93#19#','71#40#','108#24#','70#50#','47#10#','178#1#','100#26#','92#1#','76#5#','36#3#','37#007D#','30#24#','37#22#','205#42#','180#932C#','152A#31#','90#1#','31#9#','153#27#','155#008B#','44#9#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','55#1#','090Y#PLT1#','043A#24#','047B#0#','75#23#','085Y#PLT1#','073C#0FRB#','073C#0FRB#','073C#0FRB#','073C#0FRB#','106E#0#','073C#0FRB#','106E#0#','090Y#PLT1#','10#1#','134#13#','192#24#','158A#1#','090Y#PLT1#','151#14#','102#040D#','60#4#','60#3#','042E#9#','005A#25#','005A#25#','005A#25#','12#15#','72#001A#','97#15#','21#11#','6#22#','4#9#','090Y#PLT1#','55#1#','090Y#PLT1#','117#011A#','090Y#PLT1#','17#23#','074B#009B#','019B#3#','89#3#','035B#3#','149A#5#','102#21#','131#19#','8#925A#','3#018A#','47#014R#','70#024B#','21#8#','009B#0#','072B#14#','130#21#','043A#24#','41#013A#','55#1#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','12#6#','166#32#','70#006E#','090Y#PLT1#','65#13#','65#13#','65#13#','001A#1#','061B#10#','026A#6#','39#017B#','37#029A#','140#6#','129#001B#','82#2#','55#1#','090Y#PLT1#','41#018B#','41#018B#','35#36#','24#12#','14#1#','029B#4#','003A#20#','17#16#','001A#001A#','41#006B#','3#21#','188#10#','50#14#','007A#29#','120A#9#','184#28#','116#23#','68#0FRC#','090Y#PLT1#','055A#002I#','101#37#','10#12#','10#2#','60#32#','155#008B#','078A#001C#','87#021A#','14#009D#','65#1#','86#024A#','41#16#','74#8#','74#23#','74#27#','53#0#','13#14#','49#49#','43#009B#','049A#29#','35#36#','93#25#','70#024B#','55#1#','090Y#PLT1#','8#001A#','8#31#','29#006A#','090Y#PLT1#','7#8#','103#0FRH#','098B#4#','15#020B#','96#4#','93#007D#','40#026C#','129#001B#','72#38#','82#8#','090Y#PLT1#','88#924A#','090Y#PLT1#','55#1#','65#30#','133#11#','19#010B#','4#39#','090Y#PLT1#','090Y#PLT1#','070A#26#','45#20#','31#27#','78#006C#','6#27#','55#10#','083D#015B#','158A#1#','166#32#','128B#5#','83#0#','34#019J#','1#13#','7#2#','090Y#PLT1#','55#1#','022A#NP01#','138#15#','090Y#PLT1#','055A#002I#','96#009C#','108#11#','37#014A#','157#4#','181#5#','050A#16#','082C#0FRE#','43#009B#','71#25#','101#33#','80#039A#','8#008A#','42#001A#','73#0FRA#','49#22#','46#0FRC#','27#8#','55#1#','090Y#PLT1#','7#2#','75#7#','165B#5#','165B#8#','165B#25#','117#27#','013B#0#','090Y#PLT1#','14#9#','93#036I#','29#17#','73#020B#','49#12#','152#008A#','60#041A#','40#026C#','41#49#','81#016A#','61#010F#','81#10#','10#12#','55#1#','10#2#','9#7#','099Z#PLT1#','46#6#','37#029A#','39#018D#','21#007A#','55#1#','91#1#','31#27#','4#001C#','93#001A#','128B#5#','85#27#','171A#2#','020B#27#','124#14#','97#8#','27#46#','090Y#PLT1#','55#1#','079C#9#','12#6#','090Y#PLT1#','56#10#','56#10#','86#19#','7#2#','014A#15#','55#1#','090Y#PLT1#','090Y#PLT1#','69#18#','21#026E#','090Y#PLT1#','090Y#PLT1#','090Y#PLT1#','035B#3#','66#004A#','120#32#','96#009C#','93#007D#'

        );
        if(in_array($smp[0],$seccion)){
            return true;
        }elseif(in_array($smp[0]."#".$smp[1]."#",$manzana)){
            return true;
        }else{
            return false;
        }
    }

    public function getDatosUtiles($calle,$altura,$checklist)
    {
        $URL = 'http://ws.usig.buenosaires.gob.ar/datos_utiles?calle='.urlencode($calle).'&altura='.$altura.'';
        
        $datos = self::GET_JSON_OBJECT_FROM_PAGE($URL,25);    
        $datos['checklist'] = $checklist;
        return $datos;
    }


}

?>